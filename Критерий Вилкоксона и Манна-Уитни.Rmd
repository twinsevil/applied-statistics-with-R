---
title: "Критерий Вилкоксона и Манна-Уитни"
author: "Литвинцев И.С"
date: '28 ноября 2017 г '
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
## Непараметрические критерии. Проверка неоднородности двух независимых выборок
### 1. Подготовка данных

Исследуются данные о недоношенных младенцах, у которых вовремя не закрылся артериальный проток. 

Нас будут интерсовать только два признака пол и вес (Sex и Weight1). 
```{r data}
data <- read.csv("C:/Users/806263/Desktop/SPbU/Магистратура Матмех (2017-2019)/Применение статистических методов к реальным данным/Данные/baseMA.csv", sep = ";", dec = ".")

data <- data[, c("Sex", "Weight1")]
data <- na.omit(data)
head(data)

```
Посчитаем количество элементов в группах
```{r}
num_elements <- tapply(X = data$Weight1, INDEX = data$Sex, FUN = length); num_elements
```
Видим, что число элементов в группах разное. Для дальнейшего анализа нам потребуется одинаковое количество наблюдений в каждой группе. Добьемся этого. 
```{r}
K <- min(num_elements)
man <- data[data$Sex == 1, ]; 
man <- man[1:K,]; 
head(man)

woman <- data[data$Sex == 2, ];
head(woman)

data <- rbind(man, woman)
```

### 2. Критерий Вилкоксона
Признак пола делит наши данные на две группы. Критерий основан на подсчете числа инверсий в объединенной и упорядоченной выборке.

Нулевая гипотеза имеет вид:
$$H_0: v = w,$$
$$H_1: v \neq w$$
где $v$ -- число инверсий, $w$ -- число контринверсий. Проверим эту гипотезу с помощию встроенной функции. 
```{r}
data$Sex <- as.factor(data$Sex)

wilcox.test(Weight1~Sex, data, exact=T, paired=F, alternative = "two.sided")
```
p-значение больше 0.05, следовательно, нет оснований отклонить нулевую гипотезу. Различия в весе людей, сгруппированных по полу, не значимы.

### 3. Критерий Манна-Уитни
Проверяет ту же гипотезу. Ассимптотический аналог точного критерия Вилкоксона.

```{r}
wilcox.test(Weight1~Sex, data, exact=F, paired=F)
```
Как и ожидалось, получили тот же результат.
